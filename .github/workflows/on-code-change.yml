# This workflow is triggered every time a change is pushed to any branches
# Github actions command reference: https://docs.github.com/en/actions/learn-github-actions/workflow-syntax-for-github-actions
name: On Code Change (PR)

# The workflow could also be triggered on PRs
on:
  pull_request:
    types: [opened, reopened, synchronize]

jobs:
  update-signature:
    name: Update module signature
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: jahia/jahia-modules-action/update-signature@v2
        with:
          nexus_username: ${{ secrets.NEXUS_USERNAME }}
          nexus_password: ${{ secrets.NEXUS_PASSWORD }}
          nexus_enterprise_releases_url: ${{ secrets.NEXUS_ENTERPRISE_RELEASES_URL }}

  static-analysis:
    name: Static Analysis (linting, vulns)
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: Jahia/jahia-modules-action/static-analysis@v2
        with:
          node_version: 14
          auditci_level: critical

  build:
    name: Build Module
    needs: update-signature
    runs-on: ubuntu-latest
    container:
      image: jahia/cimg-mvn-cache:ga_cimg_openjdk_8.0.312-node
      credentials:
        username: ${{ secrets.DOCKERHUB_USERNAME }}
        password: ${{ secrets.DOCKERHUB_PASSWORD }}
    steps:
      - uses: actions/checkout@v3
      - uses: jahia/jahia-modules-action/build@v2
        with:
          nexus_username: ${{ secrets.NEXUS_USERNAME }}
          nexus_password: ${{ secrets.NEXUS_PASSWORD }}
          module_id: jcontent

  sonar-analysis:
    name: Sonar Analysis
    needs: build
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: jahia/jahia-modules-action/sonar-analysis@v2
        with:
          primary_release_branch: master
          github_pr_id: ${{github.event.number}}
          sonar_url: ${{ secrets.SONAR_URL }}
          sonar_token: ${{ secrets.SONAR_TOKEN }}

  integration-tests-standalone:
    name: Integration Tests (Standalone)
    needs: build
    runs-on: self-hosted
    timeout-minutes: 45
    steps:
      - uses: jahia/jahia-modules-action/helper@v2
      - uses: KengoTODA/actions-setup-docker-compose@main
        with:
          version: '1.29.2'
      - uses: actions/setup-node@v3
        with:
          node-version: 'lts/*'
      - uses: actions/checkout@v3
      - uses: jahia/jahia-modules-action/integration-tests@v2
        with:
          module_id: jcontent
          testrail_project: jContent Module
          tests_manifest: provisioning-manifest-build.yml
          jahia_image: jahia/jahia-discovery-dev:8-SNAPSHOT
          should_use_build_artifacts: true
          should_skip_testrail: true
          github_artifact_name: jcontent-standalone-artifacts-${{ github.run_number }}
          jahia_license: PGphaGlhLWxpY2Vuc2VzPgogIDxsaWNlbnNlLXBhY2thZ2UgZm9ybWF0PSIxLjIiIHByb2R1Y3Q9IkphaGlhIiByZWxlYXNlPSI4LjIuMCIgY3VzdG9tVGVybXNBbmRDb25kaXRpb25zPSJmYWxzZSIgc2lnbmF0dXJlPSJNQzBDRlFDVTNjaWZIVzZFbUJhMGw4bG1aTU1Ea3c3RE9RSVVZdzMrdTF0OERxa2tOcS9Qb0NzT0w3MjJ2Q0k9IiBjZXJ0QWxpYXM9ImphaGlhQ2VydCI+CiAgICA8bGljZW5zZSBjb21wb25lbnQ9Im9yZy5qYWhpYS5jb3JlIiBsaWNlbnNlZT0iSkFISUEtREVWLVFBIiBzaWduYXR1cmU9Ik1Dd0NGREhCcTJJWkJoM0F0VWhBcW1uSC9GcXoyREZSQWhRZzI4R3VhK05vdUJXR05vRTJrbFRxZHJSZ1lRPT0iIGNlcnRBbGlhcz0iamFoaWFDZXJ0Ij4KICAgICAgPGxpbWl0IGNsYXNzPSJvcmcuamFoaWEuc2VjdXJpdHkubGljZW5zZS5SZWxlYXNlTnVtYmVyVmFsaWRhdG9yIiBuYW1lPSJyZWxlYXNlIiB2YWx1ZT0iOC4yIHRvIDguMyIvPgogICAgPC9saWNlbnNlPgogICAgPGxpY2Vuc2UgY29tcG9uZW50PSJvcmcuamFoaWEucmVtb3RlcHVibGlzaCIgbGljZW5zZWU9IkpBSElBLURFVi1RQSIgc2lnbmF0dXJlPSJNQzBDRlFDSUNyNUpaV052MjYvMmU0WTFTMWF2SGFoVkVnSVVmWHhUMDlwa3c5d3VUK0w3ZS9ndlFiVHBDems9IiBjZXJ0QWxpYXM9ImphaGlhQ2VydCI+CiAgICAgIDxsaW1pdCBjbGFzcz0ib3JnLmphaGlhLnNlY3VyaXR5LmxpY2Vuc2UuQm9vbGVhblZhbGlkYXRvciIgbmFtZT0iZW5hYmxlZCIgdmFsdWU9InRydWUiLz4KICAgIDwvbGljZW5zZT4KICAgIDxsaWNlbnNlIGNvbXBvbmVudD0ib3JnLmphaGlhLmxpbmtjaGVja2VyIiBsaWNlbnNlZT0iSkFISUEtREVWLVFBIiBzaWduYXR1cmU9Ik1Dd0NGRzR6ZDVwVGRCM0FPTGw4WUlrODhxMStzWThMQWhRWXVIZVBZUnNHVXhrdStySUJFQklqOUY3dDVnPT0iIGNlcnRBbGlhcz0iamFoaWFDZXJ0Ij4KICAgICAgPGxpbWl0IGNsYXNzPSJvcmcuamFoaWEuc2VjdXJpdHkubGljZW5zZS5Cb29sZWFuVmFsaWRhdG9yIiBuYW1lPSJlbmFibGVkIiB2YWx1ZT0idHJ1ZSIvPgogICAgPC9saWNlbnNlPgogICAgPGxpY2Vuc2UgY29tcG9uZW50PSJvcmcuamFoaWEuYXV0aGVudGljYXRpb24ubnRsbSIgbGljZW5zZWU9IkpBSElBLURFVi1RQSIgc2lnbmF0dXJlPSJNQ3dDRkNWNjg4ZEZoUDlFM3RqUTZOMW1DN0c0eG1UeEFoUjBaZ3cwUFI5VlUzb1hHc3FTR29Scm8vWW1mUT09IiBjZXJ0QWxpYXM9ImphaGlhQ2VydCI+CiAgICAgIDxsaW1pdCBjbGFzcz0ib3JnLmphaGlhLnNlY3VyaXR5LmxpY2Vuc2UuQm9vbGVhblZhbGlkYXRvciIgbmFtZT0iZW5hYmxlZCIgdmFsdWU9InRydWUiLz4KICAgIDwvbGljZW5zZT4KICAgIDxsaWNlbnNlIGNvbXBvbmVudD0ib3JnLmphaGlhLmF1dGhlbnRpY2F0aW9uLmphYXMiIGxpY2Vuc2VlPSJKQUhJQS1ERVYtUUEiIHNpZ25hdHVyZT0iTUN3Q0ZEYmFDVkQ0RzVDelVIVDh6MnlGQU95TDBnb0tBaFJVSTVKV0ZCT0lIdm1PT1VmMHUxQjU4WEJhMlE9PSIgY2VydEFsaWFzPSJqYWhpYUNlcnQiPgogICAgICA8bGltaXQgY2xhc3M9Im9yZy5qYWhpYS5zZWN1cml0eS5saWNlbnNlLkJvb2xlYW5WYWxpZGF0b3IiIG5hbWU9ImVuYWJsZWQiIHZhbHVlPSJ0cnVlIi8+CiAgICA8L2xpY2Vuc2U+CiAgICA8bGljZW5zZSBjb21wb25lbnQ9Im9yZy5qYWhpYS5hdXRoZW50aWNhdGlvbi5zcG5lZ28iIGxpY2Vuc2VlPSJKQUhJQS1ERVYtUUEiIHNpZ25hdHVyZT0iTUN3Q0ZBS3FNZmpTNjNHS3hYRFNiQUloWnZLb3YrS2tBaFI4RmNNRlVXOGR5dFpoeTY1Q21NR0NSZFhZMmc9PSIgY2VydEFsaWFzPSJqYWhpYUNlcnQiPgogICAgICA8bGltaXQgY2xhc3M9Im9yZy5qYWhpYS5zZWN1cml0eS5saWNlbnNlLkJvb2xlYW5WYWxpZGF0b3IiIG5hbWU9ImVuYWJsZWQiIHZhbHVlPSJ0cnVlIi8+CiAgICA8L2xpY2Vuc2U+CiAgICA8bGljZW5zZSBjb21wb25lbnQ9Im9yZy5qYWhpYS5hdXRoZW50aWNhdGlvbi5jYXMiIGxpY2Vuc2VlPSJKQUhJQS1ERVYtUUEiIHNpZ25hdHVyZT0iTUN3Q0ZFcEtGVHlRektScHJVZFZJWTNvMytZQXlHbHlBaFFhK3lsd2tpV0lMa2xCQlpFL1hNYmlsYmpmQnc9PSIgY2VydEFsaWFzPSJqYWhpYUNlcnQiPgogICAgICA8bGltaXQgY2xhc3M9Im9yZy5qYWhpYS5zZWN1cml0eS5saWNlbnNlLkJvb2xlYW5WYWxpZGF0b3IiIG5hbWU9ImVuYWJsZWQiIHZhbHVlPSJ0cnVlIi8+CiAgICA8L2xpY2Vuc2U+CiAgICA8bGljZW5zZSBjb21wb25lbnQ9Im9yZy5qYWhpYS5tYW5hZ2VXb3JrZmxvdyIgbGljZW5zZWU9IkpBSElBLURFVi1RQSIgc2lnbmF0dXJlPSJNQ3dDRkhicm9POHIwamp1MzJOYzF5VkpIVGFxcVJWc0FoUXRvWFNwdEowU2pJM0FYRElqM0xZZGVTREtRZz09IiBjZXJ0QWxpYXM9ImphaGlhQ2VydCI+CiAgICAgIDxsaW1pdCBjbGFzcz0ib3JnLmphaGlhLnNlY3VyaXR5LmxpY2Vuc2UuQm9vbGVhblZhbGlkYXRvciIgbmFtZT0iZW5hYmxlZCIgdmFsdWU9InRydWUiLz4KICAgIDwvbGljZW5zZT4KICAgIDxsaWNlbnNlIGNvbXBvbmVudD0ib3JnLmphaGlhLmFkdmFuY2VkQ29udGVudFZpc2liaWxpdHkiIGxpY2Vuc2VlPSJKQUhJQS1ERVYtUUEiIHNpZ25hdHVyZT0iTUN3Q0ZCL1F3SC8wT2tEOWtINDdTazVWWVFKWEc4MlJBaFJINDhSUlNiQVRVNjNKWjlLa3hiMmJpMk1pZmc9PSIgY2VydEFsaWFzPSJqYWhpYUNlcnQiPgogICAgICA8bGltaXQgY2xhc3M9Im9yZy5qYWhpYS5zZWN1cml0eS5saWNlbnNlLkJvb2xlYW5WYWxpZGF0b3IiIG5hbWU9ImVuYWJsZWQiIHZhbHVlPSJ0cnVlIi8+CiAgICA8L2xpY2Vuc2U+CiAgICA8bGljZW5zZSBjb21wb25lbnQ9Im9yZy5qYWhpYS5wcml2YXRlQXBwU3RvcmUiIGxpY2Vuc2VlPSJKQUhJQS1ERVYtUUEiIHNpZ25hdHVyZT0iTUN3Q0ZCVkxQcVJrdkJDeVh4U0MzaERKOXFiT1Nsb3lBaFFWY3JvMEFHdWpDWkR4Z1FSMkhtL3l1b1lMMEE9PSIgY2VydEFsaWFzPSJqYWhpYUNlcnQiPgogICAgICA8bGltaXQgY2xhc3M9Im9yZy5qYWhpYS5zZWN1cml0eS5saWNlbnNlLkJvb2xlYW5WYWxpZGF0b3IiIG5hbWU9ImVuYWJsZWQiIHZhbHVlPSJ0cnVlIi8+CiAgICA8L2xpY2Vuc2U+CiAgICA8bGljZW5zZSBjb21wb25lbnQ9Im9yZy5qYWhpYS50cmFuc2xhdGlvbkdsb2JhbExpbmsiIGxpY2Vuc2VlPSJKQUhJQS1ERVYtUUEiIHNpZ25hdHVyZT0iTUN3Q0ZDbTR0THRRZ2FLRFVDc0NyQ2xVZjEySGhxNmZBaFFpR0lOczZueXkwQmIwT3FXRmowbnlDdHhuY0E9PSIgY2VydEFsaWFzPSJqYWhpYUNlcnQiPgogICAgICA8bGltaXQgY2xhc3M9Im9yZy5qYWhpYS5zZWN1cml0eS5saWNlbnNlLkJvb2xlYW5WYWxpZGF0b3IiIG5hbWU9ImVuYWJsZWQiIHZhbHVlPSJ0cnVlIi8+CiAgICA8L2xpY2Vuc2U+CiAgICA8bGljZW5zZSBjb21wb25lbnQ9Im9yZy5qYWhpYS5wb3J0YWwiIGxpY2Vuc2VlPSJKQUhJQS1ERVYtUUEiIHNpZ25hdHVyZT0iTUN3Q0ZINFpPYk9nenM0MFoyOUNnWHhmMUJFZlRKdVpBaFFvMXZvdjZvSmJZWlRhSWJhNXZ4ZmtlNnR3Y2c9PSIgY2VydEFsaWFzPSJqYWhpYUNlcnQiPgogICAgICA8bGltaXQgY2xhc3M9Im9yZy5qYWhpYS5zZWN1cml0eS5saWNlbnNlLkJvb2xlYW5WYWxpZGF0b3IiIG5hbWU9ImVuYWJsZWQiIHZhbHVlPSJ0cnVlIi8+CiAgICA8L2xpY2Vuc2U+CiAgICA8bGljZW5zZSBjb21wb25lbnQ9Im9yZy5qYWhpYS5jbWlzIiBsaWNlbnNlZT0iSkFISUEtREVWLVFBIiBzaWduYXR1cmU9Ik1Dd0NGQXgwYkJuTXczVlpodEZWM29sZWYzVFllRGhSQWhRdTlTR2lsS2J2aGk2c3pYUXhMNFZVNnJ5Ym9BPT0iIGNlcnRBbGlhcz0iamFoaWFDZXJ0Ij4KICAgICAgPGxpbWl0IGNsYXNzPSJvcmcuamFoaWEuc2VjdXJpdHkubGljZW5zZS5Cb29sZWFuVmFsaWRhdG9yIiBuYW1lPSJlbmFibGVkIiB2YWx1ZT0idHJ1ZSIvPgogICAgPC9saWNlbnNlPgogICAgPGxpY2Vuc2UgY29tcG9uZW50PSJvcmcuamFoaWEuZXNpZ2F0ZSIgbGljZW5zZWU9IkpBSElBLURFVi1RQSIgc2lnbmF0dXJlPSJNQzBDRkd0YWVPdThhc1dNczNiSW5WNXdMS1FJRWZNZEFoVUFoc3RsQVo0K2Q2cTFUWkFPVzRCcVRSR1JxTUk9IiBjZXJ0QWxpYXM9ImphaGlhQ2VydCI+CiAgICAgIDxsaW1pdCBjbGFzcz0ib3JnLmphaGlhLnNlY3VyaXR5LmxpY2Vuc2UuQm9vbGVhblZhbGlkYXRvciIgbmFtZT0iZW5hYmxlZCIgdmFsdWU9InRydWUiLz4KICAgIDwvbGljZW5zZT4KICAgIDxsaWNlbnNlIGNvbXBvbmVudD0ib3JnLmphaGlhLmVDb21tZXJjZSIgbGljZW5zZWU9IkpBSElBLURFVi1RQSIgc2lnbmF0dXJlPSJNQ3dDRkczamIrMjl4cURWRUNqcWhKZ1A4SWwxZzR0VEFoUllNNlVmRWh6NjR2Qjlyb3JUY0NyMlhPcE1OUT09IiBjZXJ0QWxpYXM9ImphaGlhQ2VydCI+CiAgICAgIDxsaW1pdCBjbGFzcz0ib3JnLmphaGlhLnNlY3VyaXR5LmxpY2Vuc2UuQm9vbGVhblZhbGlkYXRvciIgbmFtZT0iZW5hYmxlZCIgdmFsdWU9InRydWUiLz4KICAgIDwvbGljZW5zZT4KICAgIDxsaWNlbnNlIGNvbXBvbmVudD0ib3JnLmphaGlhLmZvcm1zIiBsaWNlbnNlZT0iSkFISUEtREVWLVFBIiBzaWduYXR1cmU9Ik1Dd0NGR09FKzdJRjZRbHdyc1BIcDlTRjFzVmc0ZXBCQWhRR2dmWmZhS0txVWxOamlsZEpQUnd0RERSb1ZRPT0iIGNlcnRBbGlhcz0iamFoaWFDZXJ0Ij4KICAgICAgPGxpbWl0IGNsYXNzPSJvcmcuamFoaWEuc2VjdXJpdHkubGljZW5zZS5Cb29sZWFuVmFsaWRhdG9yIiBuYW1lPSJlbmFibGVkIiB2YWx1ZT0idHJ1ZSIvPgogICAgPC9saWNlbnNlPgogICAgPGxpY2Vuc2UgY29tcG9uZW50PSJvcmcuamFoaWEuc2VhcmNoLXByb3ZpZGVyLWVsYXN0aWNzZWFyY2giIGxpY2Vuc2VlPSJKQUhJQS1ERVYtUUEiIHNpZ25hdHVyZT0iTUN3Q0ZHNFF0V2RGL0xMcWJiRllpSTdlN0tCZUtVeE9BaFFJSGg2MXg3NURKa1ZoeWFqbjVjdkJmdThGaWc9PSIgY2VydEFsaWFzPSJqYWhpYUNlcnQiPgogICAgICA8bGltaXQgY2xhc3M9Im9yZy5qYWhpYS5zZWN1cml0eS5saWNlbnNlLkJvb2xlYW5WYWxpZGF0b3IiIG5hbWU9ImVuYWJsZWQiIHZhbHVlPSJ0cnVlIi8+CiAgICA8L2xpY2Vuc2U+CiAgICA8bGljZW5zZSBjb21wb25lbnQ9Im9yZy5qYWhpYS5qRXhwZXJpZW5jZSIgbGljZW5zZWU9IkpBSElBLURFVi1RQSIgc2lnbmF0dXJlPSJNQ3dDRkVyOHZraTB5ZHI4TkFSSHlGeDA4WEMyMy9VekFoUm9VTU0vdU9Tc0ZnNnRqYURIdjQyZnJ2OUt5dz09IiBjZXJ0QWxpYXM9ImphaGlhQ2VydCI+CiAgICAgIDxsaW1pdCBjbGFzcz0ib3JnLmphaGlhLnNlY3VyaXR5LmxpY2Vuc2UuQm9vbGVhblZhbGlkYXRvciIgbmFtZT0iZW5hYmxlZCIgdmFsdWU9InRydWUiLz4KICAgIDwvbGljZW5zZT4KICAgIDxsaWNlbnNlIGNvbXBvbmVudD0ib3JnLmphaGlhLmRpc3RyaWJ1dGVkU2Vzc2lvbnMiIGxpY2Vuc2VlPSJKQUhJQS1ERVYtUUEiIHNpZ25hdHVyZT0iTUN3Q0ZEWmFYTmJrM3pLRWF2Q0Z0M01XQlhaa2RsSmxBaFFXbEliOHN0NVBabndSR2cxRDd6eS9VRXhXN3c9PSIgY2VydEFsaWFzPSJqYWhpYUNlcnQiPgogICAgICA8bGltaXQgY2xhc3M9Im9yZy5qYWhpYS5zZWN1cml0eS5saWNlbnNlLkJvb2xlYW5WYWxpZGF0b3IiIG5hbWU9ImVuYWJsZWQiIHZhbHVlPSJ0cnVlIi8+CiAgICA8L2xpY2Vuc2U+CiAgICA8bGljZW5zZSBjb21wb25lbnQ9Im9yZy5qYWhpYS5tYXJrZXRvQ29ubmVjdG9yIiBsaWNlbnNlZT0iSkFISUEtREVWLVFBIiBzaWduYXR1cmU9Ik1DMENGUUNOb0lldDlPKzJ1QWZ0cEJ3aFNNMFhLcTJQRUFJVVRvMkYzbUFUYVgveDhSZXBKT20rSHgvcGJqdz0iIGNlcnRBbGlhcz0iamFoaWFDZXJ0Ij4KICAgICAgPGxpbWl0IGNsYXNzPSJvcmcuamFoaWEuc2VjdXJpdHkubGljZW5zZS5Cb29sZWFuVmFsaWRhdG9yIiBuYW1lPSJlbmFibGVkIiB2YWx1ZT0idHJ1ZSIvPgogICAgPC9saWNlbnNlPgogICAgPGxpY2Vuc2UgY29tcG9uZW50PSJvcmcuamFoaWEubGFuZGluZ1BhZ2VGYWN0b3J5IiBsaWNlbnNlZT0iSkFISUEtREVWLVFBIiBzaWduYXR1cmU9Ik1Dd0NGQTE3anhXSkltdUVQNlhBN0NieXh5QlpPNDdxQWhRWXQ1VktuMWJSYjA5QUcxbW5IdjdjSERDdmFnPT0iIGNlcnRBbGlhcz0iamFoaWFDZXJ0Ij4KICAgICAgPGxpbWl0IGNsYXNzPSJvcmcuamFoaWEuc2VjdXJpdHkubGljZW5zZS5Cb29sZWFuVmFsaWRhdG9yIiBuYW1lPSJlbmFibGVkIiB2YWx1ZT0idHJ1ZSIvPgogICAgPC9saWNlbnNlPgogICAgPGxpY2Vuc2UgY29tcG9uZW50PSJvcmcuamFoaWEuYXRJbnRlcm5ldCIgbGljZW5zZWU9IkpBSElBLURFVi1RQSIgc2lnbmF0dXJlPSJNQ3dDRkJPOXNITUZRM3V4OXQ1TXRZTFpsdTk4VG5lNEFoUWFIODc0ZG1CU2NFenQ4TmpyNVBhOXl5a28yUT09IiBjZXJ0QWxpYXM9ImphaGlhQ2VydCI+CiAgICAgIDxsaW1pdCBjbGFzcz0ib3JnLmphaGlhLnNlY3VyaXR5LmxpY2Vuc2UuQm9vbGVhblZhbGlkYXRvciIgbmFtZT0iZW5hYmxlZCIgdmFsdWU9InRydWUiLz4KICAgIDwvbGljZW5zZT4KICAgIDxsaWNlbnNlIGNvbXBvbmVudD0ib3JnLmphaGlhLm1mR29vZ2xlQW5hbHl0aWNzIiBsaWNlbnNlZT0iSkFISUEtREVWLVFBIiBzaWduYXR1cmU9Ik1Dd0NGQkI2TVpNdWRlbE9MVEdVbHVPcld4OEZmZWVTQWhRZXNSdEEvNk5hNGFrNjltNFBxOUJVKzRPY3RBPT0iIGNlcnRBbGlhcz0iamFoaWFDZXJ0Ij4KICAgICAgPGxpbWl0IGNsYXNzPSJvcmcuamFoaWEuc2VjdXJpdHkubGljZW5zZS5Cb29sZWFuVmFsaWRhdG9yIiBuYW1lPSJlbmFibGVkIiB2YWx1ZT0idHJ1ZSIvPgogICAgPC9saWNlbnNlPgogICAgPGxpY2Vuc2UgY29tcG9uZW50PSJvcmcuamFoaWEub2F1dGhMaW5rZWRJbiIgbGljZW5zZWU9IkpBSElBLURFVi1RQSIgc2lnbmF0dXJlPSJNQ3dDRkEwWTliNlJYWjMzS0lKODM2Y21ES21vbmZwWkFoUmVtc0NTdlNLazNEazF3TFZFZWo1MFNsb0Nydz09IiBjZXJ0QWxpYXM9ImphaGlhQ2VydCI+CiAgICAgIDxsaW1pdCBjbGFzcz0ib3JnLmphaGlhLnNlY3VyaXR5LmxpY2Vuc2UuQm9vbGVhblZhbGlkYXRvciIgbmFtZT0iZW5hYmxlZCIgdmFsdWU9InRydWUiLz4KICAgIDwvbGljZW5zZT4KICAgIDxsaWNlbnNlIGNvbXBvbmVudD0ib3JnLmphaGlhLm9hdXRoRmFjZWJvb2siIGxpY2Vuc2VlPSJKQUhJQS1ERVYtUUEiIHNpZ25hdHVyZT0iTUN3Q0ZEc1UxdS9zNzFzOXJTb2tscWVHVnJMdGl6a1hBaFJPYktIT2tVM1U3NXBKZ3Zkc25OSzBYblZuT2c9PSIgY2VydEFsaWFzPSJqYWhpYUNlcnQiPgogICAgICA8bGltaXQgY2xhc3M9Im9yZy5qYWhpYS5zZWN1cml0eS5saWNlbnNlLkJvb2xlYW5WYWxpZGF0b3IiIG5hbWU9ImVuYWJsZWQiIHZhbHVlPSJ0cnVlIi8+CiAgICA8L2xpY2Vuc2U+CiAgICA8bGljZW5zZSBjb21wb25lbnQ9Im9yZy5qYWhpYS5vYXV0aEdvb2dsZSIgbGljZW5zZWU9IkpBSElBLURFVi1RQSIgc2lnbmF0dXJlPSJNQ3dDRkRQRGdnRXN4ODdYdklNM1ZZV0NNWnN6UVNYU0FoUWtPa0hGSnNVTmV6OStKZ3JDb2I5YVZPcnVNZz09IiBjZXJ0QWxpYXM9ImphaGlhQ2VydCI+CiAgICAgIDxsaW1pdCBjbGFzcz0ib3JnLmphaGlhLnNlY3VyaXR5LmxpY2Vuc2UuQm9vbGVhblZhbGlkYXRvciIgbmFtZT0iZW5hYmxlZCIgdmFsdWU9InRydWUiLz4KICAgIDwvbGljZW5zZT4KICAgIDxsaWNlbnNlIGNvbXBvbmVudD0ib3JnLmphaGlhLm9hdXRoQ29ubmVjdG9yIiBsaWNlbnNlZT0iSkFISUEtREVWLVFBIiBzaWduYXR1cmU9Ik1DMENGUUNIZDVDeE81ZUF4cDdUbzVoNU8vMjhKQVg3a2dJVWFEZjE1empObTF6RXdEYnovak5xbzlwSldXYz0iIGNlcnRBbGlhcz0iamFoaWFDZXJ0Ij4KICAgICAgPGxpbWl0IGNsYXNzPSJvcmcuamFoaWEuc2VjdXJpdHkubGljZW5zZS5Cb29sZWFuVmFsaWRhdG9yIiBuYW1lPSJlbmFibGVkIiB2YWx1ZT0idHJ1ZSIvPgogICAgPC9saWNlbnNlPgogICAgPGxpY2Vuc2UgY29tcG9uZW50PSJvcmcuamFoaWEubG9jYWxTaXRlTWFuYWdlciIgbGljZW5zZWU9IkpBSElBLURFVi1RQSIgc2lnbmF0dXJlPSJNQ3dDRkcyOXVlQ3R2cXZ1M1lFNzRWMytyam93QkRqL0FoUjdDd2p0OGhCU2pzOHRQRHJINjVmZGtGeWFwQT09IiBjZXJ0QWxpYXM9ImphaGlhQ2VydCI+CiAgICAgIDxsaW1pdCBjbGFzcz0ib3JnLmphaGlhLnNlY3VyaXR5LmxpY2Vuc2UuQm9vbGVhblZhbGlkYXRvciIgbmFtZT0iZW5hYmxlZCIgdmFsdWU9InRydWUiLz4KICAgIDwvbGljZW5zZT4KICA8L2xpY2Vuc2UtcGFja2FnZT4KPC9qYWhpYS1saWNlbnNlcz4K
          docker_username: ${{ secrets.DOCKERHUB_USERNAME }}
          docker_password: ${{ secrets.DOCKERHUB_PASSWORD }}
          nexus_username: ${{ secrets.NEXUS_USERNAME }}
          nexus_password: ${{ secrets.NEXUS_PASSWORD }}
          tests_report_name: Test report (Standalone)
          testrail_username: ${{ secrets.TESTRAIL_USERNAME }}
          testrail_password: ${{ secrets.TESTRAIL_PASSWORD }}
          incident_pagerduty_api_key: ${{ secrets.INCIDENT_PAGERDUTY_API_KEY }}
          incident_pagerduty_reporter_email: ${{ secrets.INCIDENT_PAGERDUTY_REPORTER_EMAIL }}
          incident_pagerduty_reporter_id: ${{ secrets.INCIDENT_PAGERDUTY_REPORTER_ID }}
          incident_google_spreadsheet_id: ${{ secrets.INCIDENT_GOOGLE_SPREADSHEET_ID }}
          incident_google_client_email: ${{ secrets.INCIDENT_GOOGLE_CLIENT_EMAIL }}
          incident_google_api_key_base64: ${{ secrets.INCIDENT_GOOGLE_PRIVATE_KEY_BASE64 }}
          zencrepes_secret: ${{ secrets.ZENCREPES_WEBHOOK_SECRET }}
      - name: Test Report
        uses: dorny/test-reporter@v1
        if: success() || failure()
        with:
          name: Tests Report (Standalone)
          path: tests/artifacts/results/xml_reports/**/*.xml
          reporter: java-junit
          fail-on-error: 'false'